#smote values ----
set.seed(0)
f2=read.csv("thyroidDF - Copy.csv")
f2
table(f2$target)
f2$age=as.factor(f2$age)
f2$sex=as.factor(f2$sex)
f2$on_thyroxine=as.factor(f2$on_thyroxine)
f2$query_on_thyroxine=as.factor(f2$query_on_thyroxine)
f2$on_antithyroid_meds=as.factor(f2$on_antithyroid_meds)
f2$sick=as.factor(f2$sick)
f2$pregnant=as.factor(f2$pregnant)
f2$thyroid_surgery=as.factor(f2$thyroid_surgery)
f2$I131_treatment=as.factor(f2$I131_treatment)
f2$query_hypothyroid=as.factor(f2$query_hypothyroid)
f2$query_hyperthyroid=as.factor(f2$query_hyperthyroid)
f2$lithium=as.factor(f2$lithium)
f2$goitre=as.factor(f2$goitre)
f2$tumor=as.factor(f2$tumor)
f2$hypopituitary=as.factor(f2$hypopituitary)
f2$psych=as.factor(as.factor(f2$psych))
f2$TSH_measured=as.factor(f2$TSH_measured)
f2$TSH=as.factor(f2$TSH)
f2$T3_measured=as.factor(f2$T3_measured)
f2$T3=as.factor(f2$T3)
f2$TT4_measured=as.factor(f2$TT4_measured)
f2$TT4=as.factor(f2$TT4)
f2$T4U_measured=as.factor(f2$T4U_measured)
f2$T4U=as.factor(f2$T4U)
f2$FTI_measured=as.factor(f2$FTI_measured)
f2$FTI=as.factor(f2$FTI)
f2$TBG_measured=as.factor(f2$TBG_measured)
f2$TBG=as.factor(f2$TBG)
f2$referral_source=as.factor(f2$referral_source)
f2$target=as.factor(f2$target)
f2$patient_id=as.factor(f2$patient_id)
data4=f2[,]
table(f2$target)
smotedata1=SMOTE(target~.,data4,perc.over=1700,perc.under = 200)
write.csv(smotedata1,"D:\\SEM 3\\DS\\DS CP\\Datasets\\SmoteLearn1.csv",row.names = FALSE)
fs=read.csv("SmoteLearn1.csv")
table(fs$target)

#counting ns ----
td <- read.csv("Thyroid_Dataset 4.csv")
print(td)
View(td)
str(td)
sum(is.na(td$age))
sum(is.na(td$sex))
sum(is.na(td$sex))
sum(is.na(td$on_thyroxine))
sum(is.na(td$query_on_thyroxine))
sum(is.na(td$on_antithyroid_meds))
sum(is.na(td$sick))
sum(is.na(td$pregnant))
sum(is.na(td$thyroid_surgery))
sum(is.na(td$I131_treatment))
sum(is.na(td$query_hypothyroid))
sum(is.na(td$query_hyperthyroid))
sum(is.na(td$lithium))
sum(is.na(td$goitre))
sum(is.na(td$tumor))
sum(is.na(td$hypopituitary))
sum(is.na(td$psych))
sum(is.na(td$TSH_measured))
sum(is.na(td$TSH))
sum(is.na(td$T3_measured))
sum(is.na(td$T3))
sum(is.na(td$TT4_measured))
sum(is.na(td$TT4))
sum(is.na(td$T4U_measured))
sum(is.na(td$T4U))
sum(is.na(td$FTI_measured))
sum(is.na(td$FTI))
sum(is.na(td$TBG_measured))
sum(is.na(td$TBG))
sum(is.na(td$referral_source))
sum(is.na(td$target))
sum(is.na(td$patient_id))


#imputing missing values ----
library(ggplot2)
library(cowplot)
library(randomForest)
data <- read.csv("Thyroid_Dataset 5.csv")
print(data)
View(data)
str(data)
table(data$target)
data$age <- as.numeric(data$age)
data$sex <- as.factor(data$sex)
data$on_thyroxine <- as.factor(data$on_thyroxine)
data$query_on_thyroxine <- as.factor(data$query_on_thyroxine)
data$on_antithyroid_meds <- as.factor(data$on_antithyroid_meds)
data$sick <- as.factor(data$sick)
data$pregnant <- as.factor(data$pregnant)
data$thyroid_surgery <- as.factor(data$thyroid_surgery)
data$I131_treatment <- as.factor(data$I131_treatment)
data$query_hypothyroid <- as.factor(data$query_hypothyroid)
data$query_hyperthyroid <- as.factor(data$query_hyperthyroid)
data$lithium <- as.factor(data$lithium)
data$goitre <- as.factor(data$goitre)
data$tumor <- as.factor(data$tumor)
data$hypopituitary <- as.factor(data$hypopituitary)
data$psych <- as.factor(data$psych)
data$TSH_measured <- as.factor(data$TSH_measured)
#data$TSH <- as.factor(data$TSH)
data$T3_measured <- as.factor(data$T3_measured)
#data$T3 <- as.factor(data$T3)
data$TT4_measured <- as.factor(data$TT4_measured)
#data$TT4 <- as.factor(data$TT4)
data$T4U_measured <- as.factor(data$T4U_measured)
#data$T4U <- as.factor(data$T4U)
data$FTI_measured <- as.factor(data$FTI_measured)
#data$FTI <- as.factor(data$FTI)
data$TBG_measured <- as.factor(data$TBG_measured)
data$referral_source <- as.factor(data$referral_source)
data$target <- as.factor(data$target)
data$patient_id <- as.numeric(data$patient_id)
str(data)
df<-data.frame(data$age,data$sex,data$on_thyroxine,data$query_on_thyroxine,data$on_antithyroid_meds,data$thyroid_surgery,data$query_hypothyroid,data$query_hyperthyroid,data$TSH)
#df<- data.frame(data)
#df<-data[, -c(18,22,24,26)]

set.seed(42)
data <- droplevels(data)
data.na<- data

data.imputed <- rfImpute(target ~ . ,  data=data)

write.csv(data.imputed,"D:\\Imputeset.csv",row.names = FALSE)





